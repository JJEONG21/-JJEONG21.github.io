# DB 트랙잭션

## 트랜잭션 정의

- 하나의 작업으로 이루어지는 여러 쿼리들을 트랜잭션이라는 논리적으로 하나의 작업으로 묶어 주는 것

### 트랜잭션이 생겨난 배경

- ex) update문, 구매자 계좌에서 만원 빼고, 타계좌는 더하고 → 오류 발생 방지
- 쿼리들이 한꺼번에 모두 실행되거나 아예 아무 쿼리도 실행X
- 데이터베이스가 데이터를 안정적으로 보장하도록
- 하나의 트랜잭션은 커밋 혹은 롤백
    - 커밋: 확인 도장, 트랜잭션 모든 쿼리가 성공되어 성공 결과를 DB에 저장
    - 롤백: 성공 X → 결과 취소하고 DB를 트랜잭션 이전 상태로 돌림

## 트랜잭션 4가지 성질

- `ACID`
    - 트랜잭션이 안전하게 수행된다는 것을 **이론적**으로 보장하기 위한 성질 ACID
    - **Atomicity(원자성)**
        - 트랜잭션이 DB에 모두 반영되거나 혹은 전혀 반영되지 않아야 한다.
            
            = 완료되지 않은 트랜잭션의 중간 상태를 DB에 반영해서는 안 된다
            
    - **Consistencty(일관성)**
        - 조건 위배 시 트랜잭션 종료
    - **Isolation(독립성)**
        - 둘 이상의 트랜잭션이 동시 실행되고 있을 때, 어떤 트랜잭션도 다른 트랜잭션 연산에 끼어들 수 없다.
            
            = 각각의 트랜잭션은 서로 간섭 없이 독립적으로 이루어져야 함
            
    - **Durability(지속성)**
        - 트랜잭션이 성공적으로 완료되었으면 결과는 영구히 반영되어야 함
    
- “데이터 100개가 동시에 접근하려고 한다면?”
    
    `성능의 문제 -> 트랜잭션 격리 수준`
    
    - 격리 수준과 성능은 반비례
    - 데이터 정합성(높은 격리 수준, 낮은 성능) ↔ 동시성(낮은 격리 수준)
